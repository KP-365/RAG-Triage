PRD: NHS Triage RAG Prototype (Replit MVP)
1) Product overview

Product name: TriageRAG (prototype)
Summary: A web app that collects structured symptom information, applies rule-based red flags, and generates a clinician-friendly triage summary. It also includes a RAG agent that can pull explanations from a local knowledge base (trusted docs you upload) to reduce hallucinations.

2) Problem

A&E triage is slowed down by repetitive history taking and inconsistent early risk sorting. A lightweight intake tool can capture key info upfront, surface red flags, and help clinicians prioritise safely.

3) Goals for the Replit prototype

Patient intake flow that captures symptom details in under 3 minutes.

Deterministic red-flag checks that assign a risk band (Red, Amber, Green).

Clinician view showing a clear summary plus the triggered red flags.

RAG agent that answers “why” questions using only your uploaded documents.

Basic logging of model version, rules version, and which documents were used.

4) Non-goals for the prototype

Final diagnosis or prescribing.

Paediatrics (under 18).

Full NHS integration (EPR, NHS number, HSCN).

Production-grade authentication and auditing.

5) Target users

Patient: completes questionnaire on phone or kiosk.

Clinician: views summaries and risk band, can override.

Admin (you): uploads reference docs, monitors runs and logs.

6) MVP scope
6.1 Presentations included (start with 5)

Chest pain

Shortness of breath

Abdominal pain

Headache

Fever/infection

6.2 Patient intake data

Demographics: age, sex

Chief complaint and onset

Severity (0–10)

Key symptom modifiers (worse on exertion, pleuritic, radiating, etc.)

Red-flag questions (syncope, confusion, severe bleeding, pregnancy, immunosuppression, etc.)

Basic PMH: heart disease, diabetes, anticoagulants, COPD/asthma

6.3 Outputs

Risk band: Red, Amber, Green

Triggered red flags list

Short summary for clinician (bullet format)

RAG explanation for clinician queries:

Example: “Why is this red?”

Must include citations to source document chunks

7) User flows
7.1 Patient flow

Landing page: Start assessment

Age gate: confirm 18+

Choose complaint

Dynamic questionnaire based on complaint

Submit

Confirmation page: “Thank you. A clinician will review shortly.”

7.2 Clinician flow

Clinician dashboard: list of recent submissions

Click a submission

View:

Summary

Risk band

Red flags triggered

Ask “why” (RAG) with citations

Override band and add note

Save override to logs

7.3 Admin flow

Upload documents (PDF or text)

System chunks and indexes documents

Admin can see indexing status and document list

8) Functional requirements
8.1 Frontend

Responsive UI (mobile friendly)

Form components: radio, checkbox, slider, text

Progress indicator

Clinician dashboard with list and detail view

Admin document upload page

8.2 Backend API

Required endpoints:

POST /api/triage
Input: patient intake JSON
Output: triage result JSON (band, red flags, summary)

GET /api/submissions
Output: list of submissions (for clinician dashboard)

GET /api/submissions/{id}
Output: one submission with triage output

POST /api/submissions/{id}/override
Input: override band + note
Output: success

POST /api/rag/query
Input: question + submission id
Output: answer + citations (doc name, chunk id, snippet)

POST /api/docs/upload
Input: file upload
Output: indexed document metadata

GET /api/docs
Output: list of indexed docs

8.3 Triage logic (rules first)

A rule engine that checks red flags deterministically.

Rules are versioned, for example rules_version = "0.1.0".

Safety behaviour: if required data missing, bias to higher urgency or “needs clinician review”.

Example rule (chest pain):

If chest pain + shortness of breath OR chest pain + collapse OR chest pain + diaphoresis, then Red.

8.4 RAG behaviour

RAG agent must answer only from retrieved chunks.

If retrieval returns nothing relevant, respond:

“I cannot find support in the uploaded guidance.”

Always return citations.

9) Data and database (prototype)

Use a simple DB that works well on Replit.

Recommended for Replit prototype: SQLite
Tables:

submissions

id, created_at, age, sex, complaint, answers_json, band, red_flags_json, summary_text, rules_version, model_version

overrides

id, submission_id, created_at, override_band, note

documents

id, name, source, uploaded_at

chunks

id, document_id, chunk_text, metadata_json, embedding_vector

Vector storage options:

Prototype simple: store embeddings in SQLite as blob and do cosine similarity in Python.

Slightly better: use a lightweight vector DB like Qdrant if you want, but SQLite is enough for a prototype.

10) Tech stack for Replit

Backend: Python + FastAPI

Easy to implement rules, embeddings, and RAG.

FastAPI gives you auto docs at /docs.

Frontend: React + TypeScript (Vite)

Simple forms and dashboards.

LLM for prototype:

If you can run local models: Ollama is harder on Replit.

For Replit prototype: use an API-based LLM for the RAG explanation step, but still keep your knowledge base local. If you must avoid external calls, keep RAG to retrieval and show snippets only.

Embeddings:

Prototype: sentence-transformers small model, if Replit resources allow.

If not: use hosted embeddings temporarily.

11) What to build first (order of work)

Backend first:

Implement /api/triage with rules only.

Save submissions to SQLite.

Minimal frontend:

Patient form that posts to /api/triage.

Clinician page listing submissions.

Admin doc upload + indexing:

Upload document.

Chunk to text and embed.

RAG query endpoint:

Retrieve top chunks.

Generate explanation with citations.

Overrides and logs:

Clinician override endpoint and UI.

This order gives you a working vertical slice quickly.

12) Success metrics for MVP

Patient completion rate above 80 percent in testing.

Median completion time under 3 minutes.

Red-flag recall: in test cases, all red-flag scenarios must be marked Red.

Clinician usability: summary readable in under 15 seconds.

RAG quality: explanations include citations in 100 percent of responses.

13) Risks and mitigations

Hallucinations: RAG must cite retrieved text and refuse if nothing supports the answer.

Unsafe triage: rules override any model output, conservative fallbacks.

Data handling: store minimal data, allow deletion, avoid PII in prototype.